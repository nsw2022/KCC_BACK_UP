<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="org.zerock.mapper.ProductMapper">

	<resultMap id="productResultMap"
		type="org.zerock.domain.Product">
		<result property="productId" column="product_id" />
		<result property="productName" column="product_name" />
		<result property="price" column="price" />
		<result property="imagePath" column="image_path" />
		<result property="description" column="description" />
	</resultMap>

	<select id="listProducts" resultMap="productResultMap">
        <![CDATA[
            SELECT * FROM product
        ]]>
	</select>

	<select id="listCartItems"
		resultType="org.zerock.domain.ShoppingCartItem">
    <![CDATA[
        SELECT * FROM shopping_cart WHERE user_id = #{userId}
    ]]>
	</select>

	<insert id="addToCart"
		parameterType="org.zerock.domain.ShoppingCartItem">
		INSERT INTO shopping_cart (cart_id, user_id, product_id, product_name,
		quantity, price, created_at, image_path)
		VALUES (shopping_cart_seq.NEXTVAL, #{userId}, #{productId}, #{productName},
		#{quantity}, #{price}, SYSDATE, #{imagePath})
	</insert>

	<delete id="removeFromCart" parameterType="long">
		DELETE FROM shopping_cart WHERE cart_id = #{cartId}
	</delete>

	<update id="updateCartItem"
		parameterType="org.zerock.domain.ShoppingCartItem">
		UPDATE shopping_cart
		SET quantity = #{quantity}, price = #{price}
		WHERE cart_id = #{cartId}
	</update>


</mapper>
